Attribute VB_Name = "Collate"
Option Explicit

Const OWNSHIP_LEGS_RANGE = "dOwnshipLegs"
Const ANALYSIS_SHEET_RANGE = "dAnalysisPane"


' aah, I produced this when I thought we needed a
' list of ownship legs. But, the analysis data is
' already tagged with the ownship leg, so we don't need it
' So, we don't need it :-(
'Public Function getOwnshipLegs() As Collection
    ' get the data
'    Dim data As Range
'    Set data = Range(OWNSHIP_LEGS_RANGE)
'
'    ' ready to store results
'    Dim res As Collection
'    Set res = New Collection
'
'    Dim thisRow As Range
'    Dim ctr As Integer
'    Dim thisLeg As TimePeriod
'    ctr = 0
'    For Each thisRow In data.Rows
'        If ctr = 0 Then
'            ' ok, skip the first row
'        Else
'            Dim secs As Integer
'            Dim legName As String
'            secs = thisRow.Cells(1, 1)
'            legName = thisRow.Cells(1, 2).Text
'
'            ' did it work
'            If (legName <> "") Then
'
'                ' is this a new leg?
'                If Not (legName = "#N/A") Then
'                    ' ok, new leg
'                    Set thisLeg = New TimePeriod
'                    thisLeg.StartTime = secs
'                Else
'                    thisLeg.EndTime = secs
'
'                    ' and remember it
'                    res.add thisLeg
'                End If
'            Else
'                ' ok, we're done
'                Exit For
'            End If
 '       End If
 '
'        ctr = ctr + 1
'    Next thisRow
'
'    Set getOwnshipLegs = res
'
'End Function

' test that we correctly read in ownship legs
'Public Sub testGetOwnshipLegs()
'    Debug.Print "testGetOwnshipLegs"
'
'    Dim res As Collection
'    Set res = getOwnshipLegs
'
'    If res Is Nothing Then
'        Debug.Print "didn't get anything"
'    End If
'
'    If res.Count = 0 Then
'        Debug.Print "didn't get any rows"
'    End If
'
'    If res.Count <> 19 Then
'        Debug.Print "Didn't get " & 19 & " rows, got:" & res.Count
'    End If
'
'End Sub
